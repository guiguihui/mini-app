{"version":3,"sources":["uni-app:///main.js","webpack:///D:/毕业设计/后台/mini-app/pages/mine/mine.vue?3f15","webpack:///D:/毕业设计/后台/mini-app/pages/mine/mine.vue?50fc","webpack:///D:/毕业设计/后台/mini-app/pages/mine/mine.vue?79a7","webpack:///D:/毕业设计/后台/mini-app/pages/mine/mine.vue?93cc","uni-app:///pages/mine/mine.vue"],"names":["wx","__webpack_require_UNI_MP_PLUGIN__","__webpack_require__","createPage","Page"],"mappings":"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","file":"pages/mine/mine.js","sourcesContent":["import 'uni-pages';wx.__webpack_require_UNI_MP_PLUGIN__ = __webpack_require__;\nimport Vue from 'vue'\nimport Page from './pages/mine/mine.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./mine.vue?vue&type=template&id=dcbcfe34&\"\nvar renderjs\nimport script from \"./mine.vue?vue&type=script&lang=js&\"\nexport * from \"./mine.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../it/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"pages/mine/mine.vue\"\nexport default component.exports","export * from \"-!../../../../../it/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../it/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--16-0!../../../../../it/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../../it/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../../it/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../it/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./mine.vue?vue&type=template&id=dcbcfe34&\"","var components\nvar render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../../../it/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../it/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../it/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../it/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../it/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./mine.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../it/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../it/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../it/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../it/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../it/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./mine.vue?vue&type=script&lang=js&\"","//用了element组件，自己要加载和引入\n<template>\n     <div class=\"all-container\">\n        <div class=\"all-container-padding bg\" >\n         <el-tabs v-model=\"activeName\" @tab-click=\"handleClick\">\n          <el-tab-pane label=\"基本信息\" name=\"first\">\n            <el-form :model=\"userlist\" :rules=\"rules\" ref=\"EditorUserForms\">\n                <el-form-item label=\"头像\" prop=\"avatar_url\" :label-width=\"formLabelWidth\">\n                    <el-upload class=\"avatar-uploader\" action=\"//shujiaoke.oss-cn-hangzhou.aliyuncs.com\" :before-upload=\"beforeupload\" :data=\"uploadParm\" :show-file-list=\"false\" :on-success=\"handleUpSuccess\">\n                    <img v-if=\"userlist.avatar_url\" :src=\"userlist.avatar_url\" class=\"avatar\">\n                    <i v-else class=\"el-icon-plus avatar-uploader-icon \" style=\"width:80px;height:80px;\"></i>\n                    </el-upload>\n                </el-form-item>\n                <el-form-item label=\"用户名\" prop=\"username\" :label-width=\"formLabelWidth\">\n                  <el-col :span=\"8\">  <el-input v-model=\"userlist.username\" disabled ></el-input></el-col>\n                </el-form-item>\n                <el-form-item label=\"电话\" prop=\"phone\" :label-width=\"formLabelWidth\">\n                  <el-col :span=\"8\">   <el-input v-model=\"userlist.phone\" placeholder=\"请输入电话\"></el-input></el-col>\n                </el-form-item>\n                <el-form-item label=\"邮箱\" prop=\"email\" :label-width=\"formLabelWidth\">\n                  <el-col :span=\"8\">   <el-input v-model=\"userlist.email\" placeholder=\"请输入邮箱\"></el-input></el-col>\n                </el-form-item>\n                <el-form-item label=\"用户角色\" prop=\"full_name\" :label-width=\"formLabelWidth\">\n                  <el-col :span=\"8\">\n                    <el-input v-model=\"userlist.full_name\" disabled ></el-input>\n                    </el-col>\n                </el-form-item>\n            </el-form>\n            <div class=\"grid-content bg-purple\">\n             <el-button type=\"primary\"  @click=\"EditorUserClick('userlist')\" >保存</el-button>\n            </div>\n          </el-tab-pane>\n          <el-tab-pane label=\"修改密码\" name=\"second\">\n            <el-form :model=\"ruleForm\" :rules=\"rules\" ref=\"ruleForm\">\n             <el-form-item label=\"原密码\" prop=\"pass\" :label-width=\"formLabelWidth\">\n                  <el-col :span=\"8\">   <el-input v-model=\"ruleForm.pass\" placeholder=\"请输入原密码\" type=\"password\"></el-input></el-col>\n                </el-form-item>\n                <el-form-item label=\"新密码\" prop=\"newpass\" :label-width=\"formLabelWidth\">\n                  <el-col :span=\"8\"><el-input v-model=\"ruleForm.newpass\" placeholder=\"请输入新密码\" id=\"newkey\" type=\"password\"></el-input></el-col>\n                </el-form-item>\n                <el-form-item label=\"重复新密码\" prop=\"checknewpass\" :label-width=\"formLabelWidth\">\n                  <el-col :span=\"8\">   <el-input v-model=\"ruleForm.checknewpass\" placeholder=\"请再次输入新密码\" id='newkey1' type=\"password\"></el-input></el-col>\n                </el-form-item>\n                </el-form>\n                <div class=\"grid-content bg-purple\">\n             <el-button type=\"primary\"  @click=\"submitForm('ruleForm')\">保存</el-button>\n            </div>\n          </el-tab-pane>\n        </el-tabs>\n        </div>\n     </div>\n</template>\n<script>\n\n//这一步很重要，一般我们直接从后台拿过来输出来会是在data里面，但是我发现却在store里面，这里就要用到vuex\nimport { mapGetters } from \"vuex\";\nexport default {\n  data() {\n\t//检验两次密码是否一致\n    var validatePass = (rule, value, callback) => {\n      if (value === \"\") {\n        callback(new Error(\"请输入密码\"));\n      } else {\n        if (this.ruleForm.checknewpass !== \"\") {\n          this.$refs.ruleForm.validateField(\"checknewpass\");\n        }\n        callback();\n      }\n    };\n    var validatePass2 = (rule, value, callback) => {\n      if (value === \"\") {\n        callback(new Error(\"请再次输入密码\"));\n      } else if (value !== this.ruleForm.newpass) {\n        callback(new Error(\"两次输入密码不一致!\"));\n      } else {\n        callback();\n      }\n    };\n\n    return {\n      uploadParm: {}, //图片的上传\n      ruleForm: {},//修改密码的表单\n      activeName: \"first\",\n      loading: true,\n      baseUrl: process.env.BASE_API,\n      userlist: {},//用户信息表单\n      formLabelWidth: \"150px\",\n\t\t//校验\n      rules: {\n        phone: [\n          {\n            required: true,\n            message: \"请输入电话号码\"\n          },\n          {\n            pattern: /^(13[0-9]|14[5|7]|15[0|1|2|3|5|6|7|8|9]|18[0|1|2|3|5|6|7|8|9])\\d{8}$/,\n            message: \"手机格式不对\"\n          }\n        ],\n        email: [\n          {\n            required: true,\n            message: \"请输入电子邮箱\"\n          },\n          {\n            pattern: /^([a-zA-Z0-9_-])+@([a-zA-Z0-9_-])+((\\.[a-zA-Z0-9_-]{2,3}){1,2})$/,\n            message: \"请输入有效的邮箱\"\n          }\n        ],\n\n        pass: [\n          {\n            required: true,\n            trigger: \"blur\",\n            message: \"请输入密码\"\n          }\n        ],\n\n        newpass: [\n          {\n            validator: validatePass,\n            trigger: \"blur\"\n          }\n        ],\n        checknewpass: [\n          {\n            validator: validatePass2,\n            trigger: \"blur\"\n          }\n        ]\n      }\n    };\n  },\n  created() {\n    this.getUser();\n    this.upload();\n  },\n  computed: {\n    ...mapGetters([\"username\"])\n  },\n  methods: {\n    //获取个人用户的信息\n    getUser() {\n      postData(\"接口\", this.username).then(response => {\n        if (response.status === 200) {\n          this.userlist = response.data;\n          this.loading = false;\n          console.log(this.userlist, 9696);\n        } else {\n          this.$message({\n            message: \"获取信息失败,\" + response.message,\n            type: \"error\"\n          });\n        }\n      });\n    },\n    //tab切换\n    handleClick(tab, event) {\n      console.log(tab, event);\n    },\n\n    //上传参数图片初始化\n    upload() {\n      var currentTimeStamp = new Date().getTime() / 1000;\n      if (\n        this.uploadParams == null ||\n        this.uploadParams.expire + 3 < currentTimeStamp\n      ) {\n        this.$store\n          .dispatch(\"GetUploadParams\")\n          .then(req => {\n            this.uploadParm = req.data;\n          })\n          .catch(err => {\n            this.$message({ message: err.message, type: \"warning\" });\n          });\n      } else {\n        this.uploadParm = this.uploadParams;\n      }\n    },\n    //上传之前\n    beforeupload(file) {\n      this.uploadParm.key = this.uploadParm.dir + guid();\n      // console.log(this.uploadParm)\n    },\n    //图片上传上传成功\n    handleUpSuccess(response, file, fileList) {\n      var newfile = {\n        name: file.name,\n        type: file.raw.type,\n        size: bytesToSize(file.size),\n        url: this.uploadParm.key\n      };\n      postData(\"file\", newfile).then(response => {\n        if (response.status == 200) {\n          this.$message({ message: \"修改成功\", type: \"success\" });\n          this.userlist.style_file_id = response.data.id;\n          this.userlist.avatar_url = this.baseUrl + response.data.url;\n        } else {\n          this.$message({ message: \"修改失败\", type: \"error\" });\n        }\n      });\n      console.log(this.userlist);\n    },\n    //修改密码\n    submitForm(ruleForm) {\n      var obj = {\n        username: this.username,\n        oldpwd: this.ruleForm.pass,\n        newpwd: this.ruleForm.newpass\n      };\n      console.log(obj);\n      postData(\"接口\", obj).then(response => {\n        if (response.status == 200) {\n          this.$message({\n            message: \"保存成功\",\n            type: \"success\"\n          });\n        } else {\n          this.$message({\n            message: \"修改失败\" + response.message,\n            type: \"error\"\n          });\n        }\n      });\n    },\n    // 编辑提交的方法\n    EditorUserClick() {\n      this.$refs.EditorUserForms.validate(valid => {\n        if (valid) {\n          console.log(this.userlist);\n          putData(\"接口\", this.userlist).then(response => {\n            if (response.status == 200) {\n              this.$message({\n                message: \"编辑成功\",\n                type: \"success\"\n              });\n            } else {\n              this.$message({\n                message: \"修改失败\" + response.message,\n                type: \"error\"\n              });\n            }\n          });\n       \n        }\n      });\n    }\n  }\n};\n</script>\n\n"],"sourceRoot":""}